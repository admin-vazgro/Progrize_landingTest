(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{3021:(e,t,s)=>{Promise.resolve().then(s.bind(s,9949))},9949:(e,t,s)=>{"use strict";s.d(t,{default:()=>f});var r=s(5155),a=s(2115),l=s(1142),i=s(3321),n=s(2338);function o({isOpen:e,onClose:t,onSuccess:s,userId:i}){let[n,o]=(0,a.useState)("discussion"),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[x,g]=(0,a.useState)(""),[f,h]=(0,a.useState)([]),[p,b]=(0,a.useState)("looking_for"),[v,y]=(0,a.useState)("public"),[j,N]=(0,a.useState)(!1),[w,_]=(0,a.useState)(!1),[k,C]=(0,a.useState)(""),S=e=>{let t=e.trim().replace(/^#/,"");!t||f.some(e=>e.toLowerCase()===t.toLowerCase())||h(e=>[...e,t])};if(!e)return null;let L=async e=>{if(e.preventDefault(),!d.trim()||!u.trim())return void C("Please fill in all required fields");_(!0),C("");try{let e=f.map(e=>e.trim()).filter(e=>e.length>0),{data:r,error:a}=await l.N.from("posts").insert({user_id:i,post_type:n,intent:"job_opportunity"===n||"mentorship"===n?p:null,visibility:v,title:d.trim(),content:u.trim(),tags:e,community_id:null}).select();if(a)throw a;if(r&&r.length>0){let e=r[0],{data:t}=await l.N.from("profile_follows").select("follower_id").eq("following_id",i);if(t&&t.length>0){let s=t.map(t=>({user_id:t.follower_id,actor_id:i,type:"follower_post",entity_type:"post",entity_id:e.id,meta:{title:e.title}})),{error:r}=await l.N.from("notifications").insert(s);r&&console.error("Error creating notifications:",r)}}c(""),m(""),g(""),h([]),o("discussion"),b("looking_for"),y("public"),s(),t()}catch(e){console.error("Error creating post:",e),C("Failed to create post. Please try again.")}finally{_(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"relative w-full max-w-2xl mx-4 bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition","aria-label":"Close modal",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Create Post"}),(0,r.jsxs)("form",{onSubmit:L,className:"space-y-5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Post Type"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>o("discussion"),className:`flex-1 px-4 py-3 rounded-lg border-2 text-sm font-medium transition ${"discussion"===n?"border-[#162f16] bg-[#162f16] text-white":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"Discussion"}),(0,r.jsx)("button",{type:"button",onClick:()=>o("job_opportunity"),className:`flex-1 px-4 py-3 rounded-lg border-2 text-sm font-medium transition ${"job_opportunity"===n?"border-[#162f16] bg-[#162f16] text-white":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"Job Opportunity"}),(0,r.jsx)("button",{type:"button",onClick:()=>o("event"),className:`flex-1 px-4 py-3 rounded-lg border-2 text-sm font-medium transition ${"event"===n?"border-[#162f16] bg-[#162f16] text-white":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"Event"}),(0,r.jsx)("button",{type:"button",onClick:()=>o("mentorship"),className:`flex-1 px-4 py-3 rounded-lg border-2 text-sm font-medium transition ${"mentorship"===n?"border-[#162f16] bg-[#162f16] text-white":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"Mentorship"})]}),"event"===n&&(0,r.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"For full event details (date, location), use the Events tab."})]}),("job_opportunity"===n||"mentorship"===n)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Looking for / Providing"}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>b("looking_for"),className:`flex-1 px-4 py-3 rounded-lg border-2 text-sm font-medium transition ${"looking_for"===p?"border-[#162f16] bg-[#162f16] text-white":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"Looking for"}),(0,r.jsx)("button",{type:"button",onClick:()=>b("providing"),className:`flex-1 px-4 py-3 rounded-lg border-2 text-sm font-medium transition ${"providing"===p?"border-[#162f16] bg-[#162f16] text-white":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"Providing"})]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Visibility"}),(0,r.jsxs)("button",{type:"button",onClick:()=>N(e=>!e),className:"w-full flex items-center justify-between rounded-lg border border-gray-300 px-4 py-3 text-sm text-gray-700 hover:border-gray-400",children:[(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-base",children:"\uD83C\uDF0D"}),"public"===v?"Anyone":"followers"===v?"Followers":"My company"]}),(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-500",viewBox:"0 0 24 24",fill:"none",children:(0,r.jsx)("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})]}),j&&(0,r.jsx)("div",{className:"absolute z-10 mt-2 w-full rounded-xl border border-gray-200 bg-white p-3 shadow-lg",children:[{key:"public",title:"Anyone",subtitle:"Anyone on or off Progrize"},{key:"followers",title:"Followers",subtitle:"Only your followers"},{key:"company",title:"My company",subtitle:"People in your organization"}].map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>{y(e.key),N(!1)},className:"flex w-full items-center justify-between gap-3 rounded-lg px-3 py-2 text-left hover:bg-gray-50",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.subtitle})]}),v===e.key&&(0,r.jsx)("svg",{className:"w-5 h-5 text-[#162f16]",viewBox:"0 0 24 24",fill:"none",children:(0,r.jsx)("path",{d:"M5 13l4 4L19 7",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})]},e.key))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),(0,r.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),placeholder:"Enter a descriptive title",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16]",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content *"}),(0,r.jsx)("textarea",{value:u,onChange:e=>m(e.target.value),placeholder:"Share your thoughts...",rows:6,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16] resize-none",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 rounded-lg border border-gray-300 px-3 py-2 focus-within:ring-2 focus-within:ring-[#162f16]",children:[f.map(e=>(0,r.jsxs)("span",{className:"flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 text-xs font-medium text-gray-700",children:["#",e,(0,r.jsx)("button",{type:"button",onClick:()=>h(t=>t.filter(t=>t!==e)),className:"text-gray-500 hover:text-gray-700",children:"\xd7"})]},e)),(0,r.jsx)("input",{type:"text",value:x,onChange:e=>g(e.target.value),onKeyDown:e=>{(" "===e.key||","===e.key||"Enter"===e.key)&&(e.preventDefault(),S(x),g(""))},onBlur:()=>{x.trim()&&(S(x),g(""))},placeholder:"Type and hit space",className:"flex-1 min-w-[120px] border-0 px-1 py-1 text-sm focus:outline-none"})]})]}),k&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:k}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pt-4",children:[(0,r.jsx)("button",{type:"submit",disabled:w,className:"px-6 py-3 bg-[#162f16] text-white rounded-lg font-medium hover:bg-[#0f2310] transition disabled:opacity-50",children:w?"Posting...":"Post"}),(0,r.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 bg-white border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition",children:"Cancel"})]})]})]})})}var d=s(6763),c=s(5772);function u({isOpen:e,onClose:t,onSuccess:s,userId:i}){let[n,o]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),[g,f]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),[b,v]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),[N,w]=(0,a.useState)(null),[_,k]=(0,a.useState)(""),[C,S]=(0,a.useState)(!1),[L,E]=(0,a.useState)("");if(!e)return null;let q=async e=>{try{let t=e.name.split(".").pop(),s=`${i}-${Date.now()}.${t}`,r=`event-images/${s}`,{error:a}=await l.N.storage.from("profile-pictures").upload(r,e);if(a)throw console.error("Error uploading image:",a),a;let{data:{publicUrl:n}}=l.N.storage.from("profile-pictures").getPublicUrl(r);return n}catch(e){throw console.error("Error uploading image:",e),e}},M=async e=>{if(e.preventDefault(),!n.trim()||!d.trim()||!m||!g)return void E("Please fill in all required fields");S(!0),E("");try{let e=y.split(",").map(e=>e.trim()).filter(e=>e.length>0),r=new Date(`${m}T${g}`).toISOString(),a=null;if(N)try{a=await q(N)}catch(e){E("Failed to upload image. Please try again."),S(!1);return}let{data:c,error:_}=await l.N.from("posts").insert({user_id:i,post_type:"event",title:n.trim(),content:d.trim(),tags:e,event_image:a,community_id:null}).select().single();if(_)throw _;let{error:C}=await l.N.from("events").insert({post_id:c.id,event_date:r,location:h.trim()||null,meeting_link:b.trim()||null});if(C)throw C;let{data:L}=await l.N.from("profile_follows").select("follower_id").eq("following_id",i);if(L&&L.length>0){let e=L.map(e=>({user_id:e.follower_id,actor_id:i,type:"follower_post",entity_type:"post",entity_id:c.id,meta:{title:c.title}})),{error:t}=await l.N.from("notifications").insert(e);t&&console.error("Error creating notifications:",t)}o(""),u(""),x(""),f(""),p(""),v(""),j(""),w(null),k(""),s(),t()}catch(e){console.error("Error creating event:",e),E("Failed to create event. Please try again.")}finally{S(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"relative w-full max-w-2xl mx-4 bg-white rounded-2xl shadow-2xl p-8 max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition","aria-label":"Close modal",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Create Event"}),(0,r.jsxs)("form",{onSubmit:M,className:"space-y-5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Image (optional)"}),(0,r.jsx)("div",{className:"flex items-center gap-4",children:_?(0,r.jsxs)("div",{className:"relative w-32 h-32 rounded-lg overflow-hidden",children:[(0,r.jsx)(c.default,{src:_,alt:"Event preview",fill:!0,className:"object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>{w(null),k("")},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):(0,r.jsxs)("label",{className:"w-32 h-32 flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-[#162f16] transition",children:[(0,r.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mt-2",children:"Upload Image"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];if(t){w(t);let e=new FileReader;e.onloadend=()=>{k(e.result)},e.readAsDataURL(t)}},className:"hidden"})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Title *"}),(0,r.jsx)("input",{type:"text",value:n,onChange:e=>o(e.target.value),placeholder:"Enter event title",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16]",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,r.jsx)("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:"Describe your event...",rows:4,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16] resize-none",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),(0,r.jsx)("input",{type:"date",value:m,onChange:e=>x(e.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16]",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time *"}),(0,r.jsx)("input",{type:"time",value:g,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16]",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location (optional)"}),(0,r.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"e.g. London, UK or Virtual",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Link (optional)"}),(0,r.jsx)("input",{type:"url",value:b,onChange:e=>v(e.target.value),placeholder:"https://zoom.us/... or https://meet.google.com/...",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (comma separated)"}),(0,r.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"e.g. networking, workshop, career",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16]"})]}),L&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:L}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pt-4",children:[(0,r.jsx)("button",{type:"submit",disabled:C,className:"px-6 py-3 bg-[#162f16] text-white rounded-lg font-medium hover:bg-[#0f2310] transition disabled:opacity-50",children:C?"Creating...":"Create Event"}),(0,r.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 bg-white border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition",children:"Cancel"})]})]})]})})}function m({event:e,currentUserId:t,onUpdate:s,onOpenDetail:i}){let[n,o]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),m=async r=>{if(!n){o(!0);try{if(e.user_rsvp===r){await l.N.from("event_rsvps").delete().eq("event_id",e.id).eq("user_id",t);let s="going"===r?"going_count":"interested_count";await l.N.from("events").update({[s]:Math.max(0,e[s]-1)}).eq("id",e.id)}else if(await l.N.from("event_rsvps").upsert({event_id:e.id,user_id:t,status:r}),e.user_rsvp){let t="going"===e.user_rsvp?"going_count":"interested_count",s="going"===r?"going_count":"interested_count";await l.N.from("events").update({[t]:Math.max(0,e[t]-1),[s]:e[s]+1}).eq("id",e.id)}else{let t="going"===r?"going_count":"interested_count";await l.N.from("events").update({[t]:e[t]+1}).eq("id",e.id)}s()}catch(e){console.error("Error updating RSVP:",e)}finally{o(!1)}}},x=e.going_count+e.interested_count;return(0,r.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden hover:shadow-lg transition cursor-pointer",onClick:()=>i(e.id),children:[(0,r.jsx)("div",{className:"relative h-64 bg-gray-200",children:e.event_image&&!d?(0,r.jsx)(c.default,{src:e.event_image,alt:e.title,fill:!0,className:"object-cover",onError:()=>u(!0)}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-[#162f16] to-[#2a4a2a]",children:(0,r.jsx)("svg",{className:"w-20 h-20 text-white/30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:e.location||"Virtual Event"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)("div",{className:"flex -space-x-2",children:e.attendees.slice(0,3).map((e,t)=>e.avatar_url?(0,r.jsx)(c.default,{src:e.avatar_url,alt:e.full_name,width:32,height:32,className:"w-8 h-8 rounded-full border-2 border-white object-cover",onError:e=>{e.target.style.display="none"}},t):(0,r.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-[#162f16] text-white flex items-center justify-center text-xs font-semibold",children:e.full_name.charAt(0).toUpperCase()},t))}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:x>0?`${x} + Going`:"Be the first to join"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-4 line-clamp-3",children:e.content}),(0,r.jsxs)("div",{className:"flex items-center gap-3",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:()=>m("going"),disabled:n,className:`flex-1 px-4 py-2 rounded-lg text-sm font-medium transition ${"going"===e.user_rsvp?"bg-[#162f16] text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"going"===e.user_rsvp?"Going ✓":"Go"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-50 transition",children:"Draft"})]})]})]})}var x=s(2901);function g({eventId:e,currentUserId:t,onClose:s,onUpdate:i}){let[n,o]=(0,a.useState)(null),[d,u]=(0,a.useState)([]),[m,g]=(0,a.useState)(""),[f,h]=(0,a.useState)(!1),[p,b]=(0,a.useState)(!1),[v,y]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[w,_]=(0,a.useState)(!1),[k,C]=(0,a.useState)(!1),[S,L]=(0,a.useState)(!1),[E,q]=(0,a.useState)(""),M=(0,a.useCallback)(async()=>{if(e)try{let{data:s,error:r}=await l.N.from("events").select(`
          *,
          posts!inner(*)
        `).eq("id",e).single();if(r)throw r;let a=s.posts,{data:i}=await l.N.from("profiles").select("full_name, avatar_url, occupation").eq("id",a.user_id).single(),{data:n}=await l.N.from("event_rsvps").select("status").eq("event_id",e).eq("user_id",t).single(),{data:d}=await l.N.from("post_likes").select("id").eq("post_id",a.id).eq("user_id",t).single(),{data:c}=await l.N.from("event_rsvps").select("user_id").eq("event_id",e).eq("status","going").limit(5),u=await Promise.all((c||[]).map(async e=>{let{data:t}=await l.N.from("profiles").select("full_name, avatar_url").eq("id",e.user_id).single();return t}));o({...s,post_id:a.id,title:a.title,content:a.content,event_image:a.event_image||null,user_id:a.user_id,host_name:i?.full_name||"User",host_avatar:i?.avatar_url||"",host_occupation:i?.occupation||"",user_rsvp:n?.status||null,attendees:u.filter(e=>null!==e)}),b(!!d)}catch(t){let e={message:t?.message,code:t?.code,hint:t?.hint};console.error("Error loading event details:",t,e)}},[e,t]),D=(0,a.useCallback)(async()=>{if(e)try{let{data:t,error:s}=await l.N.from("event_comments").select("*").eq("event_id",e).order("created_at",{ascending:!0});if(s)throw s;let r=await Promise.all((t||[]).map(async e=>{let{data:t}=await l.N.from("profiles").select("full_name, avatar_url").eq("id",e.user_id).single();return{...e,user_name:t?.full_name||"User",user_avatar:t?.avatar_url||""}}));u(r)}catch(e){console.error("Error loading comments:",e)}},[e]);(0,a.useEffect)(()=>{e&&(M(),D())},[e,M,D]);let P=async()=>{if(e&&n)try{p?(await l.N.from("post_likes").delete().eq("post_id",n.post_id).eq("user_id",t),await l.N.rpc("decrement_likes",{post_id:n.post_id})):(await l.N.from("post_likes").insert({post_id:n.post_id,user_id:t}),await l.N.rpc("increment_likes",{post_id:n.post_id})),b(!p),M(),i()}catch(e){console.error("Error toggling like:",e)}},A=async s=>{if(!v&&e&&n){y(!0);try{if(n.user_rsvp===s){await l.N.from("event_rsvps").delete().eq("event_id",e).eq("user_id",t);let r="going"===s?"going_count":"interested_count";await l.N.from("events").update({[r]:Math.max(0,n[r]-1)}).eq("id",e)}else if(await l.N.from("event_rsvps").upsert({event_id:e,user_id:t,status:s}),n.user_rsvp){let t="going"===n.user_rsvp?"going_count":"interested_count",r="going"===s?"going_count":"interested_count";await l.N.from("events").update({[t]:Math.max(0,n[t]-1),[r]:n[r]+1}).eq("id",e)}else{let t="going"===s?"going_count":"interested_count";await l.N.from("events").update({[t]:n[t]+1}).eq("id",e)}M(),i()}catch(e){console.error("Error updating RSVP:",e)}finally{y(!1)}}},B=async()=>{if(!j&&n){N(!0);try{let{error:e}=await l.N.from("posts").delete().eq("id",n.post_id).eq("user_id",t);if(e)throw e;i(),s()}catch(e){console.error("Error deleting event:",e),alert("Failed to delete event. Please try again.")}finally{N(!1),_(!1)}}},$=async s=>{if(s.preventDefault(),m.trim()&&e){h(!0);try{let{error:s}=await l.N.from("event_comments").insert({event_id:e,user_id:t,content:m.trim()});if(s)throw s;await l.N.rpc("increment_event_comments",{event_id:e}),g(""),D(),M(),i()}catch(e){console.error("Error posting comment:",e)}finally{h(!1)}}};if(!e||!n)return null;let U=n.going_count+n.interested_count,W=n.user_id===t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:s,children:(0,r.jsxs)("div",{className:"relative w-full max-w-3xl mx-4 bg-white rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-4 right-4 z-10 text-gray-400 hover:text-gray-600 transition bg-white rounded-full p-2","aria-label":"Close modal",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),W&&(0,r.jsxs)("div",{className:"absolute top-4 right-16 z-10",children:[(0,r.jsx)("button",{onClick:()=>_(!w),className:"p-2 text-gray-400 hover:text-red-600 transition bg-white rounded-full","aria-label":"Delete event",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),w&&(0,r.jsxs)("div",{className:"absolute right-0 top-12 bg-white rounded-lg shadow-lg border border-gray-200 p-4 z-20 w-64",children:[(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-3",children:"Are you sure you want to delete this event?"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:B,disabled:j,className:"flex-1 px-3 py-2 bg-red-600 text-white rounded-md text-sm font-medium hover:bg-red-700 transition disabled:opacity-50",children:j?"Deleting...":"Delete"}),(0,r.jsx)("button",{onClick:()=>_(!1),className:"flex-1 px-3 py-2 bg-gray-100 text-gray-700 rounded-md text-sm font-medium hover:bg-gray-200 transition",children:"Cancel"})]})]})]}),(0,r.jsx)("div",{className:"relative h-72 bg-gray-200 rounded-t-2xl overflow-hidden",children:n.event_image&&!k?(0,r.jsx)(c.default,{src:n.event_image,alt:n.title,fill:!0,className:"object-cover",onError:()=>C(!0)}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-[#162f16] to-[#2a4a2a]",children:(0,r.jsx)("svg",{className:"w-24 h-24 text-white/30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h2",{className:"text-3xl font-semibold text-gray-900 mb-2",children:n.title}),(0,r.jsxs)("p",{className:"text-gray-600",children:[n.location||"Virtual Event"," || ",new Date(n.event_date).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"flex -space-x-2",children:n.attendees.slice(0,3).map((e,t)=>e.avatar_url?(0,r.jsx)(c.default,{src:e.avatar_url,alt:e.full_name,width:40,height:40,className:"w-10 h-10 rounded-full border-2 border-white object-cover",onError:e=>{e.target.style.display="none"}},t):(0,r.jsx)("div",{className:"w-10 h-10 rounded-full border-2 border-white bg-[#162f16] text-white flex items-center justify-center text-sm font-semibold",children:e.full_name.charAt(0).toUpperCase()},t))}),(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:U>0?`${U} + Going`:"Be the first to join"})]}),n.meeting_link&&(0,r.jsx)("a",{href:n.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"inline-block px-6 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition mb-6",children:"Register here"}),(0,r.jsx)("p",{className:"text-gray-700 mb-6 whitespace-pre-wrap",children:n.content}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6 pb-6 border-b border-gray-200",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 font-medium",children:"Hosted by"}),n.host_avatar?(0,r.jsx)(c.default,{src:n.host_avatar,alt:n.host_name,width:32,height:32,className:"w-8 h-8 rounded-full object-cover",onError:e=>{e.target.style.display="none"}}):(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#162f16] text-white flex items-center justify-center text-sm font-semibold",children:n.host_name.charAt(0).toUpperCase()}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:n.host_name}),n.host_occupation&&(0,r.jsx)("p",{className:"text-xs text-gray-600",children:n.host_occupation})]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2 mb-6",children:(0,r.jsxs)("button",{onClick:P,className:"flex items-center gap-2 text-gray-600 hover:text-red-600 transition",children:[(0,r.jsx)("svg",{className:`w-6 h-6 ${p?"fill-red-600 text-red-600":"fill-none"}`,stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:n.likes_count||0})]})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Comments"}),(0,r.jsx)("div",{className:"space-y-4 mb-4",children:0===d.length?(0,r.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No comments yet. Be the first to comment!"}):d.map(e=>(0,r.jsxs)("div",{className:"flex gap-3",children:[e.user_avatar?(0,r.jsx)(c.default,{src:e.user_avatar,alt:e.user_name,width:32,height:32,className:"w-8 h-8 rounded-full object-cover",onError:e=>{e.target.style.display="none"}}):(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#162f16] text-white flex items-center justify-center text-sm font-semibold",children:e.user_name.charAt(0).toUpperCase()}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium text-sm text-gray-900",children:e.user_name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:new Date(e.created_at).toLocaleDateString("en-US",{day:"numeric",month:"long",hour:"numeric",minute:"2-digit"})}),(0,r.jsx)("p",{className:"text-sm text-gray-700",children:e.content})]})]},e.id))}),(0,r.jsxs)("form",{onSubmit:$,className:"flex gap-3",children:[(0,r.jsx)("input",{type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"Write a comment...",className:"flex-1 px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16] text-sm"}),(0,r.jsx)("button",{type:"submit",disabled:f||!m.trim(),className:"px-4 py-2 bg-[#162f16] text-white rounded-lg text-sm font-medium hover:bg-[#0f2310] transition disabled:opacity-50",children:f?"Posting...":"Post"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pt-6 border-t border-gray-200",children:[(0,r.jsx)("button",{onClick:()=>{let t=window.location.origin;q(`${t}/community?event=${e}`),L(!0)},className:"px-6 py-3 bg-white border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition",children:"Share"}),(0,r.jsx)("button",{onClick:()=>A("going"),disabled:v,className:`flex-1 px-6 py-3 rounded-lg font-medium transition ${"going"===n.user_rsvp?"bg-[#162f16] text-white":"bg-[#162f16] text-white hover:bg-[#0f2310]"}`,children:"going"===n.user_rsvp?"Going ✓":"Go"})]})]})]})}),(0,r.jsx)(x.A,{isOpen:S,onClose:()=>L(!1),title:n.title||"Event",description:n.content,authorName:n.host_name||"Host",authorAvatar:n.host_avatar,url:E,label:"Share this event"})]})}function f(){let e,t,s,c=(0,i.useRouter)(),x=(0,i.useSearchParams)(),[f,h]=(0,a.useState)(null),[p,b]=(0,a.useState)(!0),[v,y]=(0,a.useState)([]),[j,N]=(0,a.useState)([]),[w,_]=(0,a.useState)([]),[k,C]=(0,a.useState)(!1),[S,L]=(0,a.useState)(!1),[E,q]=(0,a.useState)(null),[M,D]=(0,a.useState)(null),[P,A]=(0,a.useState)("feed"),[B,$]=(0,a.useState)("all"),[U,W]=(0,a.useState)("all"),[z,F]=(0,a.useState)("all"),[V,T]=(0,a.useState)("latest"),[I,O]=(0,a.useState)([]),[H,G]=(0,a.useState)([]),[R,J]=(0,a.useState)([]),[K,X]=(0,a.useState)(""),[Q,Y]=(0,a.useState)(new Set),[Z,ee]=(0,a.useState)(null),[et,es]=(0,a.useState)(null),[er,ea]=(0,a.useState)([]),[el,ei]=(0,a.useState)(""),[en,eo]=(0,a.useState)(!1),[ed,ec]=(0,a.useState)(!1),eu=(0,a.useCallback)(async()=>{let{data:{user:e}}=await l.N.auth.getUser();e?(h(e),b(!1)):c.push("/")},[c]),em=(0,a.useCallback)(async()=>{if(f)try{let e=l.N.from("posts").select(`
          *,
          post_likes!left(user_id),
          events!left(*)
        `);e="latest"===V?e.order("created_at",{ascending:!1}):e.order("likes_count",{ascending:!1});let{data:t,error:s}=await e;if(s)throw s;let r=Array.from(new Set((t||[]).map(e=>e.user_id))),{data:a}=await l.N.from("experiences").select("user_id, company_name").in("user_id",r).eq("is_current",!0),i=new Map;(a||[]).forEach(e=>{e.user_id&&e.company_name&&(i.has(e.user_id)||i.set(e.user_id,e.company_name))});let n=await Promise.all((t||[]).map(async e=>{let{data:t}=await l.N.from("profiles").select("full_name, avatar_url, occupation").eq("id",e.user_id).single(),s=e.post_likes?.some(e=>e.user_id===f?.id)||!1,r=null;if("event"===e.post_type&&e.events&&e.events.length>0){let t=e.events[0],{data:s}=await l.N.from("event_rsvps").select("status").eq("event_id",t.id).eq("user_id",f?.id).single();r={...t,user_rsvp:s?.status||null}}return{...e,user_name:t?.full_name||"User",user_avatar:t?.avatar_url||"",user_occupation:t?.occupation||"",user_company:i.get(e.user_id)||null,is_liked:s,event:r}}));y(n)}catch(e){console.error("Error loading posts:",e)}},[f,V]),ex=(0,a.useCallback)(async()=>{if(f)try{let e=l.N.from("events").select(`
          *,
          posts!inner(*)
        `);e="latest"===V?e.order("event_date",{ascending:!1}):e.order("going_count",{ascending:!1});let{data:t,error:s}=await e;if(s)throw s;let r=await Promise.all((t||[]).map(async e=>{let t=e.posts,{data:s}=await l.N.from("profiles").select("full_name, avatar_url").eq("id",t.user_id).single(),{data:r}=await l.N.from("event_rsvps").select("status").eq("event_id",e.id).eq("user_id",f?.id).single(),{data:a}=await l.N.from("event_rsvps").select("user_id").eq("event_id",e.id).eq("status","going").limit(5),i=await Promise.all((a||[]).map(async e=>{let{data:t}=await l.N.from("profiles").select("full_name, avatar_url").eq("id",e.user_id).single();return t}));return{...e,post_id:t.id,title:t.title,content:t.content,event_image:t.event_image,tags:t.tags||[],user_id:t.user_id,user_name:s?.full_name||"User",user_avatar:s?.avatar_url||"",user_rsvp:r?.status||null,attendees:i.filter(Boolean)}}));N(r)}catch(e){console.error("Error loading events:",e)}},[f,V]),eg=(0,a.useCallback)(()=>{let e=[...v],t=er.map(e=>e.toLowerCase());"events"===P&&(e=e.filter(e=>"event"===e.post_type)),"all"!==B&&(e=e.filter(e=>e.post_type===B)),"all"!==U&&(e=e.filter(e=>e.intent===U)),I.length>0&&(e=e.filter(e=>e.tags&&e.tags.some(e=>I.includes(e)))),K.trim()&&(e=e.filter(e=>e.tags&&e.tags.some(e=>e.toLowerCase().includes(K.toLowerCase())))),t.length>0&&(e=e.filter(e=>{let s=t.some(t=>e.user_occupation?.toLowerCase().includes(t)),r=t.some(t=>e.title?.toLowerCase().includes(t)),a=t.some(t=>e.content?.toLowerCase().includes(t)),l=e.tags?.some(e=>t.some(t=>e.toLowerCase().includes(t)));return!!(s||r||a||l)})),_(e=e.filter(e=>e.user_id===f?.id||!e.visibility||"public"===e.visibility||("followers"===e.visibility?Q.has(e.user_id):"company"!==e.visibility||!!Z&&!!e.user_company&&e.user_company.toLowerCase()===Z.toLowerCase())))},[v,P,B,U,I,K,er,Q,Z,f?.id]),ef=(0,a.useCallback)(()=>{let e=[...j];return K.trim()&&(e=e.filter(e=>e.title.toLowerCase().includes(K.toLowerCase())||e.content.toLowerCase().includes(K.toLowerCase()))),H.length>0&&(e=e.filter(e=>H.some(t=>e.location?.toLowerCase().includes(t.toLowerCase())))),R.length>0&&(e=e.filter(e=>e.tags?.some(e=>R.some(t=>e.toLowerCase().includes(t.toLowerCase()))))),"going"===z&&(e=e.filter(e=>"going"===e.user_rsvp)),"hosted"===z&&(e=e.filter(e=>e.user_id===f?.id)),e},[j,K,H,R,z,f?.id]);(0,a.useEffect)(()=>{eu()},[eu]),(0,a.useEffect)(()=>{em(),ex()},[em,ex]),(0,a.useEffect)(()=>{eg()},[eg]),(0,a.useEffect)(()=>{let e=x.get("post"),t=x.get("event");t&&(A("events"),q(t)),e&&(A("feed"),D(e))},[x]),(0,a.useEffect)(()=>{if(!M||"feed"!==P)return;let e=document.querySelector(`[data-post-id="${M}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"center"})},[M,P,w]),(0,a.useEffect)(()=>{f?(async()=>{let{data:e}=await l.N.from("profiles").select("full_name, avatar_url, occupation, location, professional_summary, skills, feed_preferences").eq("id",f.id).maybeSingle();es(e??null),ea(e?.feed_preferences||[])})():es(null)},[f]),(0,a.useEffect)(()=>{if(!f){Y(new Set),ee(null);return}(async()=>{let[{data:e},{data:t}]=await Promise.all([l.N.from("profile_follows").select("following_id").eq("follower_id",f.id),l.N.from("experiences").select("company_name").eq("user_id",f.id).eq("is_current",!0).limit(1)]);Y(new Set((e||[]).map(e=>e.following_id))),ee(t?.[0]?.company_name||null)})()},[f]);let eh=async e=>{if(f){ec(!0);try{let{error:t}=await l.N.from("profiles").update({feed_preferences:e}).eq("id",f.id);if(t)throw t;ea(e)}catch(e){console.error("Error updating feed preferences:",e),alert("Failed to update preferences. Please try again.")}finally{ec(!1)}}},ep=async()=>{let e=el.trim();if(!e)return;if(er.some(t=>t.toLowerCase()===e.toLowerCase()))return void ei("");let t=[...er,e];ei(""),await eh(t)},eb=async e=>{let t=er.filter(t=>t!==e);await eh(t)},ev=e=>{O(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};if(p)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("p",{className:"text-gray-600",children:"Loading..."})});let ey=ef(),ej=et?.full_name||f?.user_metadata?.full_name||f?.email?.split("@")[0]||"User",eN=(()=>{if(!et)return 0;let e=[et.full_name,et.occupation,et.location,et.professional_summary,et.skills&&et.skills.length>0?"yes":""];return Math.round(e.filter(Boolean).length/e.length*100)})();return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(n.A,{onAuthClick:()=>{c.push("/")}}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h1",{className:"text-4xl font-regular text-gray-900 mb-1",children:["Welcome Back, ",ej,"\uD83D\uDC4B"]}),(0,r.jsx)("p",{className:"text-gray-600",children:"Let's collaborate and network."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-6 mb-8 border-b border-gray-200",children:[(0,r.jsx)("button",{onClick:()=>A("feed"),className:`pb-3 px-4 font-medium transition ${"feed"===P?"text-[#162f16] border-b-2 border-[#162f16]":"text-gray-600 hover:text-gray-900"}`,children:"Live Feed"}),(0,r.jsx)("button",{onClick:()=>A("events"),className:`pb-3 px-4 font-medium transition ${"events"===P?"text-[#162f16] border-b-2 border-[#162f16]":"text-gray-600 hover:text-gray-900"}`,children:"Events"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[260px_minmax(0,1fr)_280px] gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 sticky top-6 space-y-6",children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"text",value:K,onChange:e=>X(e.target.value),placeholder:"Search tags (#JLUX)",className:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#162f16] text-sm"})}),"feed"===P?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-2 font-medium",children:"Tags"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:(e=new Set,v.forEach(t=>{t.tags&&t.tags.forEach(t=>e.add(t))}),Array.from(e)).map(e=>(0,r.jsxs)("button",{onClick:()=>ev(e),className:`px-3 py-1 rounded-full text-xs font-medium transition ${I.includes(e)?"bg-[#162f16] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["#",e]},e))})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-2 font-medium",children:"Location"}),(0,r.jsx)("div",{className:"space-y-2",children:Array.from(new Set(j.map(e=>e.location).filter(Boolean))).map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:H.includes(e),onChange:()=>{G(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:"w-4 h-4 text-[#162f16]"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:e})]},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-2 font-medium",children:"Theme"}),(0,r.jsx)("div",{className:"space-y-2",children:(t=new Set,j.forEach(e=>{e.tags?.forEach(e=>t.add(e))}),Array.from(t).slice(0,8)).map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:R.includes(e),onChange:()=>{J(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:"w-4 h-4 text-[#162f16]"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:e})]},e))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("span",{className:"text-lg",children:"\uD83D\uDD25"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 font-medium",children:"Top Hashtag"})]}),(0,r.jsx)("div",{className:"space-y-2",children:(s=new Map,v.forEach(e=>{e.tags&&e.tags.forEach(e=>{s.set(e,(s.get(e)||0)+1)})}),Array.from(s.entries()).sort((e,t)=>t[1]-e[1]).slice(0,5)).map(([e,t])=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("button",{onClick:()=>ev(e),className:"text-sm text-gray-700 hover:text-[#162f16] transition",children:["#",e]}),(0,r.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-medium",children:t})]},e))})]})]})}),(0,r.jsxs)("div",{className:"lg:col-span-1",children:["feed"===P?(0,r.jsxs)("div",{className:"bg-white rounded-xl p-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[et?.avatar_url?(0,r.jsx)("img",{src:et.avatar_url,alt:ej,className:"w-10 h-10 rounded-full object-cover"}):(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-[#162f16] text-white flex items-center justify-center text-sm font-semibold",children:ej.charAt(0).toUpperCase()}),(0,r.jsx)("button",{onClick:()=>C(!0),className:"flex-1 text-left px-4 py-2 rounded-lg bg-gray-50 text-sm text-gray-500 hover:bg-gray-100 transition",children:"What's on your mind"})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:[{label:"Discussion",type:"discussion"},{label:"Job Opportunity",type:"job_opportunity"},{label:"Events",type:"event"},{label:"Mentorship",type:"mentorship"}].map(e=>(0,r.jsx)("button",{onClick:()=>$(e.type),className:"px-3 py-1 rounded-full text-xs bg-[#e8f5e8] text-[#162f16] hover:bg-[#dff0df] transition",children:e.label},e.label))}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:[{label:"All",value:"all"},{label:"Looking for",value:"looking_for"},{label:"Providing",value:"providing"}].map(e=>(0,r.jsx)("button",{onClick:()=>W(e.value),className:`px-3 py-1 rounded-full text-xs border transition ${U===e.value?"border-[#162f16] bg-[#162f16] text-white":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:e.label},e.label))}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 text-gray-500",children:[(0,r.jsx)("button",{className:"hover:text-[#162f16]","aria-label":"Add image",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h18M3 19h18M5 5v14M19 5v14"})})}),(0,r.jsx)("button",{className:"hover:text-[#162f16]","aria-label":"Add link",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 015.657 5.656l-3 3a4 4 0 01-5.657-5.656m-1.414 1.414a4 4 0 00-5.657-5.656l-3 3a4 4 0 005.657 5.656"})})}),(0,r.jsx)("button",{className:"hover:text-[#162f16]","aria-label":"Add location",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 11c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm0 0c-4.418 0-8 2.239-8 5v3h16v-3c0-2.761-3.582-5-8-5z"})})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"Draft"}),(0,r.jsxs)("button",{onClick:()=>C(!0),className:"px-4 py-2 bg-[#162f16] text-white rounded-md text-sm font-medium hover:bg-[#0f2310] transition flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12h16m0 0l-6-6m6 6l-6 6"})}),"Post"]})]})]})]}):(0,r.jsxs)("div",{className:"bg-white rounded-xl p-4 mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-1",children:["Welcome Back, ",ej,"\uD83D\uDC4B"]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Create an event post."}),(0,r.jsx)("button",{onClick:()=>L(!0),className:"px-4 py-2 bg-[#162f16] text-white rounded-md text-sm font-medium hover:bg-[#0f2310] transition",children:"Create Event"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 mb-4",children:["events"===P&&(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:[{label:"All events",value:"all"},{label:"Going",value:"going"},{label:"Hosted",value:"hosted"}].map(e=>(0,r.jsx)("button",{onClick:()=>F(e.value),className:`px-3 py-1.5 rounded-full text-xs font-medium border transition ${z===e.value?"border-[#162f16] bg-[#162f16] text-white":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:e.label},e.value))}),(0,r.jsx)("div",{className:"flex items-center justify-end",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Sort by:"}),(0,r.jsxs)("select",{value:V,onChange:e=>T(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-[#162f16]",children:[(0,r.jsx)("option",{value:"latest",children:"Latest"}),(0,r.jsx)("option",{value:"top",children:"Top"})]})]})})]}),"feed"===P?(0,r.jsx)("div",{className:"space-y-4",children:0===w.length?(0,r.jsx)("div",{className:"bg-white rounded-xl p-12 text-center",children:(0,r.jsx)("p",{className:"text-gray-600",children:"No posts found. Be the first to post!"})}):w.map(e=>(0,r.jsx)("div",{"data-post-id":e.id,children:(0,r.jsx)(d.A,{post:e,currentUserId:f?.id||"",onUpdate:em})},e.id))}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:0===ey.length?(0,r.jsx)("div",{className:"col-span-2 bg-white rounded-xl p-12 text-center",children:(0,r.jsx)("p",{className:"text-gray-600",children:"No events found. Create the first event!"})}):ey.map(e=>(0,r.jsx)(m,{event:e,currentUserId:f?.id||"",onUpdate:ex,onOpenDetail:q},e.id))})]}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"sticky top-6 space-y-6",children:[(0,r.jsx)("div",{className:"bg-[#162f16] rounded-2xl p-6 text-white",children:(0,r.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,r.jsx)("div",{className:"w-24 h-24 rounded-full border-2 border-[#d4af37] overflow-hidden mb-4",children:et?.avatar_url?(0,r.jsx)("img",{src:et.avatar_url,alt:ej,className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full bg-[#2a4a2a] flex items-center justify-center text-2xl font-semibold",children:ej.charAt(0).toUpperCase()})}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:ej}),(0,r.jsx)("p",{className:"text-sm text-gray-300",children:et?.occupation||"Professional"}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:et?.location||"Location"}),(0,r.jsxs)("div",{className:"w-full mt-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-300 mb-2",children:[(0,r.jsx)("span",{children:"Profile completion"}),(0,r.jsxs)("span",{children:[eN,"%"]})]}),(0,r.jsx)("div",{className:"w-full h-2 bg-[#234323] rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-[#d4af37]",style:{width:`${eN}%`}})})]})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-gray-900",children:"Feed Preference"}),(0,r.jsx)("button",{onClick:()=>eo(e=>!e),className:"text-xs text-[#162f16] hover:underline",children:en?"Done":"Edit"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Select what you want to explore"}),en&&(0,r.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,r.jsx)("input",{type:"text",value:el,onChange:e=>ei(e.target.value),placeholder:"Add a tag, role, or company",className:"flex-1 px-3 py-2 rounded-lg bg-gray-50 text-sm focus:outline-none focus:ring-2 focus:ring-[#162f16]"}),(0,r.jsx)("button",{onClick:ep,disabled:ed,className:"px-3 py-2 bg-[#162f16] text-white rounded-lg text-xs font-medium hover:bg-[#0f2310] transition disabled:opacity-50",children:"Add"})]}),0===er.length?(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"No preferences yet."}):(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:er.map(e=>(0,r.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs bg-[#e8f5e8] text-[#162f16] flex items-center gap-1",children:[e,en&&(0,r.jsx)("button",{onClick:()=>eb(e),className:"text-[#162f16] hover:text-red-600","aria-label":`Remove ${e}`,children:"\xd7"})]},e))})]})]})})]})]}),(0,r.jsx)(o,{isOpen:k,onClose:()=>C(!1),onSuccess:em,userId:f?.id||""}),(0,r.jsx)(u,{isOpen:S,onClose:()=>L(!1),onSuccess:()=>{em(),ex()},userId:f?.id||""}),(0,r.jsx)(g,{eventId:E,currentUserId:f?.id||"",onClose:()=>q(null),onUpdate:()=>{em(),ex()}})]})}}},e=>{e.O(0,[12,591,338,763,441,794,358],()=>e(e.s=3021)),_N_E=e.O()}]);