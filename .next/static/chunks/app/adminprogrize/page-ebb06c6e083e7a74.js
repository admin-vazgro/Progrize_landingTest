(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[422],{3531:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(5155),l=s(2115),r=s(2338);function o(){let[e,t]=(0,l.useState)("profiles"),[s,o]=(0,l.useState)(""),[n,i]=(0,l.useState)(!1),[d,c]=(0,l.useState)([]),[x,p]=(0,l.useState)([]),[m,u]=(0,l.useState)([]),[g,h]=(0,l.useState)(null),[f,y]=(0,l.useState)({full_name:"",occupation:"",location:""}),b=(0,l.useMemo)(()=>s.trim(),[s]),j=async()=>{i(!0);try{let e=await fetch(`/api/adminprogrize/profiles?q=${encodeURIComponent(b)}`),t=await e.json();c(t.data||[])}finally{i(!1)}},N=async()=>{i(!0);try{let e=await fetch(`/api/adminprogrize/posts?q=${encodeURIComponent(b)}`),t=await e.json();p(t.data||[])}finally{i(!1)}},w=async()=>{i(!0);try{let e=await fetch("/api/adminprogrize/reports"),t=await e.json();u(t.data||[])}finally{i(!1)}};(0,l.useEffect)(()=>{"profiles"===e?j():"posts"===e?N():w()},[e,b]);let v=async e=>{await fetch("/api/adminprogrize/actions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})},_=async e=>{let t=window.prompt("Reason for flag (optional):")||"";await v({action:"flag_user",userId:e,reason:t}),await j()},k=async e=>{let t=window.prompt("Reason for ban (optional):")||"";await v({action:"ban_user",userId:e,reason:t}),await j()},C=async e=>{await v({action:"reset_user",userId:e}),await j()},S=async e=>{window.confirm("Delete user and all their data?")&&(await v({action:"delete_user",userId:e}),await j())},P=async e=>{window.confirm("Delete this post?")&&(await v({action:"delete_post",postId:e}),await N())},R=async e=>{window.confirm("Force remove this reported post?")&&(await v({action:"delete_post",postId:e}),await w(),await N())},F=async()=>{g&&(await v({action:"edit_user",userId:g.id,full_name:f.full_name,occupation:f.occupation,location:f.location}),h(null),await j())};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(r.A,{onAuthClick:()=>{}}),(0,a.jsx)("div",{className:"max-w-6xl mx-auto px-6 py-10",children:(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold text-gray-900",children:"Admin Panel"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Monitor profiles, posts, and reports."})]}),(0,a.jsx)("input",{value:s,onChange:e=>o(e.target.value),placeholder:"Search profiles, posts, locations...",className:"w-full max-w-sm px-4 py-2 rounded-lg border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-[#162f16]"})]}),(0,a.jsx)("div",{className:"flex gap-4 border-b border-gray-200",children:[{key:"profiles",label:"Profiles"},{key:"posts",label:"Posts"},{key:"reports",label:"Reports"}].map(s=>(0,a.jsx)("button",{onClick:()=>t(s.key),className:`pb-3 text-sm font-medium transition ${e===s.key?"text-[#162f16] border-b-2 border-[#162f16]":"text-gray-500 hover:text-gray-700"}`,children:s.label},s.key))}),n&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Loading..."}),!n&&"profiles"===e&&(0,a.jsx)("div",{className:"space-y-4",children:0===d.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No profiles found."}):d.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl p-5 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:e.full_name||"User"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[e.occupation||"Professional"," \xb7 ",e.location||"Location"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Posts: ",e.posts_count," \xb7 Followers: ",e.followers_count??0," \xb7 Following:"," ",e.following_count??0]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[e.is_flagged&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded-full text-xs",children:"Flagged"}),e.is_banned&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-xs",children:"Banned"})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>{h(e),y({full_name:e.full_name||"",occupation:e.occupation||"",location:e.location||""})},className:"px-3 py-2 text-xs rounded-lg border border-gray-200 hover:border-[#162f16] hover:text-[#162f16] transition",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>_(e.id),className:"px-3 py-2 text-xs rounded-lg border border-yellow-200 text-yellow-700 hover:bg-yellow-50 transition",children:"Flag"}),(0,a.jsx)("button",{onClick:()=>k(e.id),className:"px-3 py-2 text-xs rounded-lg border border-red-200 text-red-700 hover:bg-red-50 transition",children:"Ban"}),(0,a.jsx)("button",{onClick:()=>C(e.id),className:"px-3 py-2 text-xs rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 transition",children:"Reset"}),(0,a.jsx)("button",{onClick:()=>S(e.id),className:"px-3 py-2 text-xs rounded-lg border border-gray-200 text-gray-600 hover:text-red-600 transition",children:"Delete"})]})]},e.id))}),!n&&"posts"===e&&(0,a.jsx)("div",{className:"space-y-4",children:0===x.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No posts found."}):x.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl p-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.user_name," \xb7 ",e.post_type," \xb7"," ",new Date(e.created_at).toLocaleDateString()]})]}),(0,a.jsx)("button",{onClick:()=>P(e.id),className:"text-xs text-red-600 hover:underline",children:"Delete"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700 line-clamp-2",children:e.content})]},e.id))}),!n&&"reports"===e&&(0,a.jsx)("div",{className:"space-y-4",children:0===m.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No reports yet."}):m.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl p-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold text-gray-900",children:["Report ",e.id.slice(0,8)]}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.status})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Reporter: ",e.reporter_id||"Unknown"," \xb7 Target user:"," ",e.target_user_id||"N/A"," \xb7 Target post: ",e.target_post_id||"N/A"]}),e.target_post_title&&(0,a.jsxs)("p",{className:"text-sm text-gray-700 mt-3",children:["Post: ",(0,a.jsx)("span",{className:"font-semibold",children:e.target_post_title})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700 mt-3",children:e.reason||"No reason provided."}),e.target_post_id&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("button",{onClick:()=>R(e.target_post_id),className:"px-3 py-2 text-xs rounded-lg border border-red-200 text-red-700 hover:bg-red-50 transition",children:"Force Remove Post"})})]},e.id))})]})}),g&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Profile"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{value:f.full_name,onChange:e=>y({...f,full_name:e.target.value}),placeholder:"Full name",className:"w-full px-3 py-2 rounded-lg border border-gray-200 text-sm"}),(0,a.jsx)("input",{value:f.occupation,onChange:e=>y({...f,occupation:e.target.value}),placeholder:"Occupation",className:"w-full px-3 py-2 rounded-lg border border-gray-200 text-sm"}),(0,a.jsx)("input",{value:f.location,onChange:e=>y({...f,location:e.target.value}),placeholder:"Location",className:"w-full px-3 py-2 rounded-lg border border-gray-200 text-sm"})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,a.jsx)("button",{onClick:F,className:"flex-1 px-4 py-2 bg-[#162f16] text-white rounded-lg text-sm font-medium hover:bg-[#0f2310] transition",children:"Save"}),(0,a.jsx)("button",{onClick:()=>h(null),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition",children:"Cancel"})]})]})})]})}},3713:(e,t,s)=>{Promise.resolve().then(s.bind(s,3531))}},e=>{e.O(0,[12,591,338,441,794,358],()=>e(e.s=3713)),_N_E=e.O()}]);