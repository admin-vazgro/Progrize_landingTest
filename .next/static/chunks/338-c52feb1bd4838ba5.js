"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[338],{1142:(e,t,a)=>{a.d(t,{N:()=>s});let s=(0,a(8936).createClient)("https://jfjmpljeavukknfnrbwa.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impmam1wbGplYXZ1a2tuZm5yYndhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4NjA5ODYsImV4cCI6MjA4MTQzNjk4Nn0.Dc0rOSbzHtq6dtn-Rtg79Jk4DUSJe6RP49gp0r3KwCs")},2338:(e,t,a)=>{a.d(t,{A:()=>h});var s=a(5155),r=a(2115),n=a(1142),i=a(5772),l=a(8500),o=a.n(l),c=a(3321);let d={src:"/_next/static/media/mlogo.28bf4bd7.svg",height:36,width:46,blurWidth:0,blurHeight:0};function h({onAuthClick:e}){let t=(0,c.useRouter)(),a=(0,c.usePathname)(),[l,h]=(0,r.useState)(null),[m,u]=(0,r.useState)(!1),[x,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!1),[b,y]=(0,r.useState)(""),[j,N]=(0,r.useState)(null),[v,w]=(0,r.useState)([]),[_,k]=(0,r.useState)(0);(0,r.useEffect)(()=>{n.N.auth.getSession().then(({data:{session:e}})=>{h(e?.user??null)});let{data:{subscription:e}}=n.N.auth.onAuthStateChange((e,t)=>{h(t?.user??null)});return()=>e.unsubscribe()},[]),(0,r.useEffect)(()=>{l?(async()=>{let{data:e,error:t}=await n.N.from("profiles").select("full_name, avatar_url").eq("id",l.id).maybeSingle();t||N(e??null)})():N(null)},[l]),(0,r.useEffect)(()=>{if(!l){w([]),k(0);return}(async()=>{let{data:e,error:t}=await n.N.from("notifications").select("*").eq("user_id",l.id).order("created_at",{ascending:!1}).limit(10);if(t)return console.error("Error loading notifications:",t);let a=e||[],s=Array.from(new Set(a.map(e=>e.actor_id).filter(Boolean))),r=new Map;if(s.length>0){let{data:e}=await n.N.from("profiles").select("id, full_name, avatar_url").in("id",s);(e||[]).forEach(e=>{r.set(e.id,{full_name:e.full_name,avatar_url:e.avatar_url})})}let i=a.map(e=>{let t=e.actor_id?r.get(e.actor_id):void 0;return{...e,actor_name:t?.full_name||"User",actor_avatar:t?.avatar_url||""}});w(i),k(i.filter(e=>!e.read_at).length)})();let e=n.N.channel(`notifications-${l.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${l.id}`},e=>{let t=e.new;w(e=>[t,...e].slice(0,10)),k(e=>e+1)}).subscribe();return()=>{n.N.removeChannel(e)}},[l]);let C=async()=>{await n.N.auth.signOut(),u(!1),g(!1),t.push("/")},S=()=>{l?t.push("/community"):e("sign_in"),f(!1)},I=()=>j?.avatar_url?j.avatar_url:l?.user_metadata?.avatar_url||"",$=async()=>{l&&(await n.N.from("notifications").update({read_at:new Date().toISOString()}).eq("user_id",l.id).is("read_at",null),w(e=>e.map(e=>e.read_at?e:{...e,read_at:new Date().toISOString()})),k(0))};return(0,s.jsxs)("header",{className:"py-6 bg-white border-b border-gray-100 sticky top-0 z-40",children:[(0,s.jsxs)("div",{className:"container mx-auto flex items-center justify-between px-4",children:[(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsx)(o(),{href:"/",children:(0,s.jsx)(i.default,{src:d,alt:"Progrize logo",className:"w-auto h-8"})})}),l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("nav",{className:"hidden md:flex items-center gap-6 lg:px-12 text-sm text-gray-600",children:[(0,s.jsx)("button",{className:"hover:text-[#162f16] transition",children:"Find Job"}),(0,s.jsx)("button",{className:"hover:text-[#162f16] transition",children:"Job Dashboard"}),(0,s.jsx)("button",{onClick:S,className:`hover:text-[#162f16] transition ${"/community"===a?"text-[#162f16] font-semibold":""}`,children:"Community"})]}),(0,s.jsxs)("div",{className:"hidden md:flex items-center gap-4 flex-1 justify-end",children:[(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault();let a=b.trim();a&&t.push(`/search?q=${encodeURIComponent(a)}`)},className:"relative w-full max-w-md",children:(0,s.jsx)("input",{type:"text",value:b,onChange:e=>y(e.target.value),placeholder:"Search for...",className:"w-full px-4 py-2 border border-gray-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-[#162f16]"})}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:async()=>{let e=!p;g(e),e&&await $()},className:"relative p-2 rounded-full hover:bg-gray-100 transition","aria-label":"Notifications",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V4a2 2 0 10-4 0v1.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0a3 3 0 11-6 0m6 0H9"})}),_>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-semibold px-1.5 py-0.5 rounded-full",children:_>9?"9+":_})]}),p&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[(0,s.jsx)("div",{className:"px-4 py-3 border-b border-gray-100",children:(0,s.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:"Notifications"})}),(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===v.length?(0,s.jsx)("p",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:"No notifications yet."}):v.map(e=>{let a,r,n,l;return(0,s.jsxs)("button",{onClick:()=>{g(!1),"post"===e.entity_type&&e.entity_id?t.push(`/community?post=${e.entity_id}`):"follow"===e.type&&e.actor_id&&t.push(`/user/${e.actor_id}`)},className:`w-full px-4 py-3 flex gap-3 text-left hover:bg-gray-50 ${e.read_at?"bg-white":"bg-blue-50/40"}`,children:[e.actor_avatar?(0,s.jsx)(i.default,{src:e.actor_avatar,alt:e.actor_name||"User",width:36,height:36,className:"w-9 h-9 rounded-full object-cover"}):(0,s.jsx)("div",{className:"w-9 h-9 rounded-full bg-[#162f16] text-white flex items-center justify-center text-xs font-semibold",children:(e.actor_name||"U").charAt(0).toUpperCase()}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-900",children:[(0,s.jsx)("span",{className:"font-semibold",children:e.actor_name||"User"})," ",(e=>{let t=e.meta?.title||"your post";switch(e.type){case"like":return`liked ${t}`;case"comment":return`commented on ${t}`;case"follow":return"started following you";case"follower_post":return`shared a post: ${t}`;default:return"sent you a notification"}})(e)]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:(a=new Date(e.created_at),l=Math.floor((n=Math.floor((r=Math.floor((new Date().getTime()-a.getTime())/6e4))/60))/24),r<1?"Just now":r<60?`${r}m ago`:n<24?`${n}h ago`:`${l}d ago`)})]})]},e.id)})})]})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>u(!m),className:"flex items-center gap-3 hover:opacity-80 transition",children:[I()?(0,s.jsx)(i.default,{src:I(),alt:"Profile",width:40,height:40,className:"w-10 h-10 rounded-full object-cover"}):(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-[#162f16] text-white flex items-center justify-center font-semibold",children:j?.full_name?j.full_name.charAt(0).toUpperCase():l?.user_metadata?.first_name?l.user_metadata.first_name.charAt(0).toUpperCase():l?.email?l.email.charAt(0).toUpperCase():"U"}),(0,s.jsx)("svg",{className:`w-4 h-4 text-gray-600 transition-transform ${m?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),m&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[(0,s.jsx)("button",{onClick:()=>{t.push("/profile"),u(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"Profile"}),(0,s.jsx)("button",{onClick:()=>{t.push("/community"),u(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"Community"}),(0,s.jsx)("button",{onClick:()=>u(!1),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"Settings"}),(0,s.jsx)("hr",{className:"my-2 border-gray-200"}),(0,s.jsx)("button",{onClick:C,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-50",children:"Sign Out"})]})]})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("nav",{className:"hidden md:flex items-center gap-10 text-sm tracking-wider text-gray-600",children:[(0,s.jsx)("a",{href:"#features",className:"hover:text-[#162f16] transition",children:"Features"}),(0,s.jsx)("a",{href:"#testimonials",className:"hover:text-[#162f16] transition",children:"Testimonials"}),(0,s.jsx)("a",{href:"/upcoming",className:"hover:text-[#162f16] transition",children:"Resources"}),(0,s.jsx)("button",{onClick:S,className:`hover:text-[#162f16] transition ${"/community"===a?"text-[#162f16] font-semibold":""}`,children:"Community"})]}),(0,s.jsxs)("div",{className:"hidden md:flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>e("sign_in"),className:"px-4 py-2 text-gray-700 hover:text-gray-900 transition",children:"Sign In"}),(0,s.jsx)("button",{onClick:()=>e("sign_up"),className:"px-4 py-2 bg-[#162f16] text-white rounded-md hover:bg-[#0f2310] transition",children:"Sign Up"})]})]}),(0,s.jsx)("button",{onClick:()=>f(!x),"aria-label":"Open menu",className:"md:hidden p-2",children:x?(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}):(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),(0,s.jsx)("div",{className:`md:hidden transition-all duration-300 overflow-hidden ${x?"max-h-96 opacity-100":"max-h-0 opacity-0"}`,children:(0,s.jsxs)("nav",{className:"flex flex-col gap-4 px-6 py-4 bg-white border-t border-gray-200 text-sm tracking-wide",children:[(0,s.jsx)("a",{href:"#features",className:"py-2 hover:text-[#162f16]",onClick:()=>f(!1),children:"Features"}),(0,s.jsx)("a",{href:"#testimonials",className:"py-2 hover:text-[#162f16]",onClick:()=>f(!1),children:"Testimonials"}),(0,s.jsx)("a",{href:"/upcoming",className:"py-2 hover:text-[#162f16]",onClick:()=>f(!1),children:"Resources"}),(0,s.jsx)("button",{onClick:S,className:"text-left py-2 hover:text-[#162f16]",children:"Community"}),l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{t.push("/profile"),f(!1)},className:"text-left py-2 hover:text-[#162f16]",children:"Profile"}),(0,s.jsx)("button",{onClick:C,className:"text-left py-2 text-red-600 hover:text-red-700",children:"Sign Out"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{e("sign_in"),f(!1)},className:"text-left py-2 hover:text-[#162f16]",children:"Sign In"}),(0,s.jsx)("button",{onClick:()=>{e("sign_up"),f(!1)},className:"mt-2 px-4 py-2 bg-[#162f16] text-white text-center rounded-md",children:"Sign Up"})]})]})})]})}}}]);